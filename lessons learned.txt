По всесибу:
1.) на монитор глубоко похуй, че знаем как решать - решаем, остальное - ну не судьба. Если совсем нет идей - скипаем
2.) меньше обсуждать решения задач (если оно не сильно сложное) бывает полезно, особенно на простых задачах, вот когда решение будет падать, тогда и будем разбираться
3.) 

По дорешке всесиба:
1.) делать вектор со статическим выделением даёт профит, но не великий (-20% времени), поэтому обычно можно забить
2.) а вот использование мапки для нумерации вершин вполне может быть помойкой и садить производительность больше чем в 2 раза (тогда нужно нумеровать ручками)
3.) возвращать новый объект вместо переиспользования существующего может сильно садить производительность

HLD на ребрах - в вершине пишем значение на ребре в предка. Тогда запрос на пути